r
c
r
c
r
set follow-fork-mode parent
r
stack
stack 10
bt
f 7
stack 24
c
break *0x80489b4
r
x/s 0x08048e78
x /bin/sh
x "/bin/sh"
vmmap
vmmap 0x804b1a0
x
x hi
set {str}0x8048e78="sh"
set {char[4]}0x8048e78="sh"
c
set follow-fork-mode parent
r
c
c
c
exit
set follow-fork-mode parent
break system
r
clear
b *0x080489b4
c
clear
b *0x080489b4
set follow-fork-mode parent
r
x/s 0x08048e78
set {char[3]} 0x8048e78 = "sh"
x/s 0x08048e78
c
x/x 0x08048e78
x/wx 0x08048e78
x/2wx 0x08048e78
n
iao
c
finish
finish
n
vmmap
info reg eip
s
vmmap 0xf7e1e5d0
got
plt
x/wx 08048540
x/wx 0x8048540
x/x 0x8048541
x/x 0x8048542
set {int}0x8048542=0x804a2ac
x/x 0x8048542
set {int}0x8048542=0x804a2a4
x/x 0x8048542
c
c
r
c
set {int}0x8048542=0x804a2a4
c
c
c
c
c
info reg
c
x/x 0x8048542
x/4x 0x8048542
c
c
c
x/4x 0x8048542
stack
f 5
stack
stack 20
c
c
c
c
vmmap
vmmap 0x8048542
vmmap 0x0804a2ac
got
plt
vmmap 0x0804a2a4
c
sh
c
c
x/4x a
x/4x 0x804a2ac
got
exit
ll
break main
r
break showboard 
c
break showboard 
r
bt
clear
q
c
got
set {int}0x804a2ac=0x804b018
got
c
vmmap
r
vmmap
vmmap
vmmap got
section got
section
section got
section got
section --h
section help
help section
info files
plt
got
vmmap 0x0804b018
got
vmmap 0x8048546
info files 0x8048546
got
x/x 0x804a2ac
x/hx 0x804a2ac
x/hx 0x804a2ac-2
x/hx 0x804a2ac-1
x/hx 0x804a2ac+4
x/hx 0x804a2ac+2
c
got
c
got
x/x 0x804a2ac
x/hx 0x804a2ae
c
s
f
finish
got
n
c
c
sh
c
got
c
got
c
c
got
c
c
c
c
c
c
got
0x20-0x9
python3 -c "print(hex(0x20-0x9))"
c
