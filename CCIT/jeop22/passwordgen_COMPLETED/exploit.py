from pwn import *
from Crypto.Cipher import DES
from Crypto.Util.Padding import pad

conn = remote('10.20.30.40', 9600)

for word in open('wordlist.txt').readlines():
    print(conn.recvuntil(b'> '))
    conn.sendline(b'2')
    conn.sendline(b'admin')
    conn.recvuntil(b': ')
    
    cipher = DES.new(key = b"\x00"*8, mode = DES.MODE_ECB)
    random_psw = cipher.encrypt(pad(word.strip().encode(), 8))
    password = random_psw.hex()[:12]
    conn.sendline(password)
